---
xnat_server_specific_plugin_urls: []

xnat_server_specific_plugin_packages: []

# Set this to true if selinux is enabled on the hosting OS
selinux_enabled: true

# web server VM
xnat_web_server:
  host: "{{ hostvars['mirsg_dev_xnat_web']['ansible_host'] }}"
  url: "https://{{ hostvars['mirsg_dev_xnat_web']['ansible_host'] }}:30203"
  ip: "{{ hostvars['mirsg_dev_xnat_web']['harvester_cluster_base_ip'] }}"
  subnet: "{{ hostvars['mirsg_dev_xnat_web']['harvester_cluster_base_ip'] }}/24"
  subnet_mask: "{{ hostvars['mirsg_dev_xnat_web']['harvester_cluster_subnet_mask'] }}"
  storage_dir: "/data"

# XNAT plugins require PostgreSQL 9.4 or later
postgres_version: "12"

# database server VM
xnat_db:
  host: "{{ hostvars['mirsg_dev_xnat_db']['harvester_pg_svc'] }}"
  port: 5432
  listen_addresses: "'*'"
  postgres_xnat_database: "xnat"
  postgres_xnat_user: "xnat"
  postgres_xnat_password: "{{ vault_postgres_xnat_password }}"
  storage_dir: "/var/lib/pgsql"
  data_dir: "/var/lib/pgsql/{{ postgres_version }}/data"
  backups_dir: "/var/lib/pgsql/backups"

# SSL certificate settings
ssl:
  use_ssl: true
  server_cert: "/etc/ssl/certs/{{ hostvars['mirsg_dev_xnat_web']['ansible_host'] }}.cert"
  server_key: "/etc/ssl/certs/{{ hostvars['mirsg_dev_xnat_web']['ansible_host'] }}.key"
  validate_certs: no

dicom_port: 8104
xnat_dicom_port: 8105

pipeline_engine_enabled: true
container_service_enabled: false
monitoring_service_enabled: false

container_service_remote_xnat_root: ""

# XNAT configuration
xnat_config:
  site_name: "MIRSG_DEV_XNAT"
  site_description: "<h1>MIRSG Dev XNAT</h1><p>A test instance of XNAT deployed on mirsg-dev."
  admin_password: "{{ vault_admin_password }}"

# Mail server settings
smtp:
  enabled: "true"
  hostname: "192.168.56.101"
  port: "2525"
  protocol: "smtp"
  auth: ""
  username: ""
  password: "{{ vault_smtp_password }}"
  start_tls: "false"
  ssl_trust: "*"

# XNAT configuration shared between all servers
xnat_common_config:
  admin_email: "xnatadmin@{{ hostvars['mirsg_dev_xnat_web']['ansible_host'] }}"
  restrictUserListAccessToAdmins: true
  uiAllowNonAdminProjectCreation: false
  allowNonAdminsToClaimUnassignedSessions: true
  reloadPrearcDatabaseOnStartup: true
  par: false
  primaryAdminUsername: "{{ xnat_service_admin.username }}"
  receivedFileUser: "{{ xnat_service_admin.username }}"
  ipsThatCanSendEmailsThroughRest: "127.0.0.1"
  sessionXmlRebuilderInterval: "5"
  # "^.*$" for all IPs
  enabledProviders: ["localdb"]
  enableSitewideAnonymizationScript: true
  sitewideAnonymizationScript: "//\nversion \"6.1\"\nproject != \"Unassigned\" ? (0008,1030) := project\n(0010,0010) := subject\n(0010,0020) := session"

# mirsg.firewalld
public_zone_sources: []

# IP ranges for HTTP/HTTPS
work_zone_sources:
  - "0.0.0.0/0"
  - "10.0.2.2/0"

# IP ranges allowing SSH access in addition to HTTP/HTTPS/DICOM SCP
internal_zone_sources:
  - "192.168.56.1/32"
  - "192.168.56.101/32"
  - "10.52.0.0/24"
  - "128.16.8.47/32"
  - "10.0.2.2/24"
  - "10.53.77.45/32"
  - "10.53.236.96/32"
