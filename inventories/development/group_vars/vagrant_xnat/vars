---
xnat_server_specific_plugin_urls: []

xnat_server_specific_plugin_packages: []

# Set this to true if selinux is enabled on the hosting OS
selinux_enabled: false

# Mount point for external storage
EXTERNAL_STORAGE_DRIVE: "/storage"

# web server VM
xnat_web_server:
  host: "{{ hostvars['vagrant_xnat_web']['ansible_host'] }}"
  url: "https://{{ hostvars['vagrant_xnat_web']['ansible_host'] }}"
  ip: "{{ hostvars['vagrant_xnat_web']['ansible_ip'] }}"
  storage_dir: "{{ EXTERNAL_STORAGE_DRIVE }}/data"

# database server VM
xnat_db:
  host: "{{ hostvars['vagrant_xnat_db']['ansible_host'] }}"
  port: 5432
  postgres_xnat_database: "xnat"
  postgres_xnat_user: "xnat"
  postgres_xnat_password: "{{ vault_postgres_xnat_password }}"
  storage_dir: "{{ EXTERNAL_STORAGE_DRIVE }}/pgsql"
  data_dir: "{{ EXTERNAL_STORAGE_DRIVE }}/pgsql/{{ postgresql_version }}/data"
  backups_dir: "{{ EXTERNAL_STORAGE_DRIVE }}/pgsql/backups"

# SSL certificate settings
ssl:
  use_ssl: true
  server_cert: "/etc/ssl/certs/{{ hostvars['vagrant_xnat_web']['ansible_host'] }}.cert"
  server_key: "/etc/ssl/certs/{{ hostvars['vagrant_xnat_web']['ansible_host'] }}.key"
  validate_certs: no

# nginx config
dicom_port: 8104
xnat_dicom_port: 8105

pipeline_engine_enabled: true
container_service_enabled: true
monitoring_service_enabled: true

container_service_remote_xnat_root: "/storage/web/data/xnat"

# XNAT configuration
xnat_config:
  site_name: "VAGRANT_XNAT"
  site_description: "<h1>Vagrant XNAT</h1><p>A vagrant test instance of XNAT."
  admin_password: "{{ vault_admin_password }}"

# Mail server settings
smtp:
  enabled: "true"
  hostname: "192.168.56.101"
  port: "2525"
  protocol: "smtp"
  auth: ""
  username: ""
  password: "{{ vault_smtp_password }}"
  start_tls: "false"
  ssl_trust: "*"

# XNAT configuration shared between all servers
xnat_common_config:
  admin_email: "xnatadmin@{{ hostvars['vagrant_xnat_web']['ansible_host'] }}"
  restrictUserListAccessToAdmins: true
  uiAllowNonAdminProjectCreation: false
  allowNonAdminsToClaimUnassignedSessions: true
  reloadPrearcDatabaseOnStartup: true
  par: false
  primaryAdminUsername: "{{ xnat_service_admin.username }}"
  receivedFileUser: "{{ xnat_service_admin.username }}"
  ipsThatCanSendEmailsThroughRest: "127.0.0.1"
  sessionXmlRebuilderInterval: "5"
  # "^.*$" for all IPs
  enabledProviders: ["localdb"]
  enableSitewideAnonymizationScript: true
  sitewideAnonymizationScript: "//\nversion \"6.1\"\nproject != \"Unassigned\" ? (0008,1030) := project\n(0010,0010) := subject\n(0010,0020) := session"

public_zone_sources: []

# IP ranges for HTTP/HTTPS
work_zone_sources:
  - "0.0.0.0/0"

# IP ranges allowing SSH access in addition to HTTP/HTTPS/DICOM SCP
internal_zone_sources:
  - "192.168.56.1/32"
  - "{{ hostvars['vagrant_xnat_web']['ansible_ip'] }}/32"
  - "{{ hostvars['vagrant_xnat_db']['ansible_ip'] }}/32"
  - "{{ hostvars['vagrant_xnat_cserv']['ansible_ip'] }}/32"
  - "192.168.56.101/32"
  - "10.0.2.2/32"
